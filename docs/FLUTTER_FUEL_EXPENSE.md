# Изменения в Flutter приложении: Расходы на топливо по технике

## Описание изменений

Обновлено Flutter приложение для поддержки указания расходов на топливо для каждой единицы техники отдельно при завершении заявки.

## Что изменилось

### 1. Удалено общее поле расхода на топливо

- Удалено общее поле `_fuelExpenseController` из формы завершения заявки
- Удалено общее поле "Расходы на топливо" из секции "Расходы"
- Удалена отправка общего `fuel_expense` при завершении заявки

### 2. Добавлено поле расхода на топливо для каждой техники

- Добавлено поле `fuelExpense` в класс `SelectedItem`
- Добавлено поле ввода расхода на топливо в диалог добавления техники
- Добавлено поле ввода расхода на топливо в диалог редактирования техники
- Расходы на топливо отображаются под каждой единицей техники в списке

### 3. Обновлена модель OrderItem

- Добавлено поле `fuelExpense` в модель `OrderItem`
- Добавлена обработка `fuel_expense` при парсинге JSON от сервера
- Добавлена обработка `fuel_expense` при отправке данных на сервер

## Как использовать

### Добавление техники с расходами на топливо

1. При завершении заявки нажмите "Добавить элемент"
2. Выберите вкладку "Техника"
3. Нажмите "+" у нужной техники
4. В открывшемся диалоге:
   - Укажите количество смен
   - Укажите количество часов
   - **Укажите расходы на топливо (опционально)**
5. Нажмите "Добавить"

### Редактирование расходов на топливо

1. В списке добавленных элементов найдите нужную технику
2. Нажмите кнопку редактирования (иконка карандаша)
3. В открывшемся диалоге измените расходы на топливо
4. Нажмите "Сохранить"

### Отображение расходов на топливо

- Расходы на топливо отображаются под каждой единицей техники в списке
- Формат: "Расходы на топливо: X.XX ₽"
- Отображаются только если указаны расходы (> 0)

## Технические детали

### Измененные файлы

1. `mobile/lib/features/orders/screens/complete_order_screen.dart`
   - Удалено общее поле `_fuelExpenseController`
   - Добавлено поле `fuelExpense` в класс `SelectedItem`
   - Добавлены поля ввода в диалоги добавления/редактирования техники
   - Обновлена отправка данных: `fuel_expense` отправляется для каждой техники отдельно

2. `mobile/lib/features/orders/models/order_models.dart`
   - Добавлено поле `fuelExpense` в модель `OrderItem`
   - Добавлена обработка `fuel_expense` при парсинге JSON
   - Добавлена обработка `fuel_expense` в методе `toJson`

### Формат данных

При отправке данных на сервер для каждой единицы техники:

```json
{
  "item_type": "equipment",
  "ref_id": 1,
  "quantity": 16.0,
  "unit": "час",
  "unit_price": "2450.00",
  "tax_rate": "0.00",
  "discount": "0.00",
  "fuel_expense": "5000.00",  // Расходы на топливо для данной техники
  "metadata": {
    "shifts": 2.0,
    "hours": 0.0
  }
}
```

## Обратная совместимость

- Старые заявки без указания `fuel_expense` продолжают работать корректно
- Поле `fuel_expense` является опциональным
- Если `fuel_expense` не указан или равен 0, расходы на топливо не создаются для данной техники

