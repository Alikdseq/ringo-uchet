# ‚úÖ –î–ï–ô–°–¢–í–ò–ï 4: –ü–û–î–ì–û–¢–û–í–ö–ê BACKEND –ù–ê –°–ï–†–í–ï–†–ï

## üéØ –¶–ï–õ–¨
–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–µ–∫—Ç –Ω–∞ —Å–µ—Ä–≤–µ—Ä –∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –∫ –∑–∞–ø—É—Å–∫—É.

---

## ‚ùì –í–û–ü–†–û–° –ü–ï–†–ï–î –ù–ê–ß–ê–õ–û–ú

**–ï—Å—Ç—å –ª–∏ —É –≤–∞—Å –¥–æ–º–µ–Ω –¥–ª—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è?**
- –ï—Å–ª–∏ –î–ê ‚Üí –∑–∞–ø–∏—à–∏—Ç–µ –¥–æ–º–µ–Ω (–Ω–∞–ø—Ä–∏–º–µ—Ä: `ringo-uchet.ru`)
- –ï—Å–ª–∏ –ù–ï–¢ ‚Üí –∏—Å–ø–æ–ª—å–∑—É–µ–º IP –∞–¥—Ä–µ—Å –ø–æ–∫–∞ (–¥–æ–º–µ–Ω –Ω–∞—Å—Ç—Ä–æ–∏–º –ø–æ–∑–∂–µ)

---

## üìã –®–ê–ì 1: –ó–ê–ì–†–£–ó–ö–ê –ü–†–û–ï–ö–¢–ê –ù–ê –°–ï–†–í–ï–†

**–£ –≤–∞—Å –µ—Å—Ç—å 2 –≤–∞—Ä–∏–∞–Ω—Ç–∞:**

### –í–ê–†–ò–ê–ù–¢ –ê: –ß–µ—Ä–µ–∑ Git (–µ—Å–ª–∏ –ø—Ä–æ–µ–∫—Ç –≤ Git —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏)

```bash
cd ~
git clone https://github.com/–≤–∞—à-—é–∑–µ—Ä–Ω–µ–π–º/ringo-uchet.git
# –∏–ª–∏ –µ—Å–ª–∏ GitLab:
# git clone https://gitlab.com/–≤–∞—à-—é–∑–µ—Ä–Ω–µ–π–º/ringo-uchet.git
cd ringo-uchet
```

### –í–ê–†–ò–ê–ù–¢ –ë: –ß–µ—Ä–µ–∑ SCP (–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —Å –≤–∞—à–µ–≥–æ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞)

**–ù–∞ –í–ê–®–ï–ú –∫–æ–º–ø—å—é—Ç–µ—Ä–µ (Windows PowerShell):**

```powershell
# –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –ø–∞–ø–∫—É —Å –ø—Ä–æ–µ–∫—Ç–æ–º
cd C:\ringo-uchet

# –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –ø—Ä–æ–µ–∫—Ç –Ω–∞ —Å–µ—Ä–≤–µ—Ä (–∑–∞–º–µ–Ω–∏—Ç–µ –í–ê–®_IP –∏ –ø—É—Ç—å –∫ –ø—Ä–æ–µ–∫—Ç—É)
scp -r . root@–í–ê–®_IP:~/ringo-uchet
```

**–ó–∞—Ç–µ–º –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ:**

```bash
cd ~/ringo-uchet
```

---

## üìã –®–ê–ì 2: –ü–ï–†–ï–•–û–î –í –î–ò–†–ï–ö–¢–û–†–ò–Æ –ü–†–û–ï–ö–¢–ê

```bash
cd ~/ringo-uchet
ls -la
```

**–î–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å –ø–∞–ø–∫–∏:** `backend/`, `mobile/`, `docs/` –∏ –¥—Ä—É–≥–∏–µ.

---

## üìã –®–ê–ì 3: –°–û–ó–î–ê–ù–ò–ï .ENV –§–ê–ô–õ–ê –î–õ–Ø PRODUCTION

### 3.1 –ü–µ—Ä–µ—Ö–æ–¥ –≤ backend

```bash
cd ~/ringo-uchet/backend
```

### 3.2 –°–æ–∑–¥–∞–Ω–∏–µ .env —Ñ–∞–π–ª–∞

```bash
nano .env
```

**–í –æ—Ç–∫—Ä—ã–≤—à–µ–º—Å—è —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ nano –≤—Å—Ç–∞–≤—å—Ç–µ —Å–ª–µ–¥—É—é—â–µ–µ:**

```env
# Django Production Settings
DJANGO_SETTINGS_MODULE=ringo_backend.settings.prod
DJANGO_SECRET_KEY=–ó–ê–ú–ï–ù–ò–¢–ï_–ù–ê_–°–ï–ö–†–ï–¢–ù–´–ô_–ö–õ–Æ–ß
DJANGO_DEBUG=False
DJANGO_ALLOWED_HOSTS=–í–ê–®_IP_–ê–î–†–ï–°,–≤–∞—à-–¥–æ–º–µ–Ω.ru,www.–≤–∞—à-–¥–æ–º–µ–Ω.ru

# CORS (–µ—Å–ª–∏ –¥–æ–º–µ–Ω–∞ –Ω–µ—Ç, —É–∫–∞–∂–∏—Ç–µ IP)
CORS_ALLOWED_ORIGINS=http://–í–ê–®_IP_–ê–î–†–ï–°,https://–≤–∞—à-–¥–æ–º–µ–Ω.ru
CORS_ALLOW_CREDENTIALS=True

# Database
DB_HOST=db
DB_PORT=5432
DB_NAME=ringo_prod
DB_USER=ringo_user
DB_PASSWORD=–°–ò–õ–¨–ù–´–ô_–ü–ê–†–û–õ–¨_–ë–î_–ó–ê–ú–ï–ù–ò–¢–ï
POSTGRES_DB=ringo_prod
POSTGRES_USER=ringo_user
POSTGRES_PASSWORD=–°–ò–õ–¨–ù–´–ô_–ü–ê–†–û–õ–¨_–ë–î_–ó–ê–ú–ï–ù–ò–¢–ï
POSTGRES_HOST=db
POSTGRES_PORT=5432

# Redis
REDIS_URL=redis://redis:6379/0
CELERY_BROKER_URL=redis://redis:6379/0
CELERY_RESULT_BACKEND=redis://redis:6379/0

# S3/MinIO
AWS_ACCESS_KEY_ID=minioadmin
AWS_SECRET_ACCESS_KEY=–°–ò–õ–¨–ù–´–ô_–ü–ê–†–û–õ–¨_MINIO_–ó–ê–ú–ï–ù–ò–¢–ï
AWS_BUCKET=ringo-media-prod
AWS_S3_ENDPOINT_URL=http://minio:9000
AWS_S3_REGION_NAME=us-east-1

# MinIO
MINIO_ROOT_USER=minioadmin
MINIO_ROOT_PASSWORD=–°–ò–õ–¨–ù–´–ô_–ü–ê–†–û–õ–¨_MINIO_–ó–ê–ú–ï–ù–ò–¢–ï

# JWT
JWT_ACCESS_MINUTES=30
JWT_REFRESH_DAYS=7
```

**–í nano:**
- –î–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è: `Ctrl + O`, –∑–∞—Ç–µ–º `Enter`
- –î–ª—è –≤—ã—Ö–æ–¥–∞: `Ctrl + X`

### 3.3 –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–µ–∫—Ä–µ—Ç–Ω—ã—Ö –∫–ª—é—á–µ–π

**–í SSH —Ç–µ—Ä–º–∏–Ω–∞–ª–µ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:**

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏–º Python –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–ª—é—á–µ–π (–µ—Å–ª–∏ –Ω–µ—Ç)
sudo apt install -y python3 python3-pip

# –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º DJANGO_SECRET_KEY
python3 -c "from django.core.management.utils import get_random_secret_key; print(get_random_secret_key())"
```

**–°–∫–æ–ø–∏—Ä—É–π—Ç–µ –ø–æ–ª—É—á–µ–Ω–Ω—ã–π –∫–ª—é—á!**

–ó–∞—Ç–µ–º:

```bash
# –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –∫–ª—é—á —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è (–µ—Å–ª–∏ –Ω—É–∂–µ–Ω)
python3 -c "from cryptography.fernet import Fernet; print(Fernet.generate_key().decode())"
```

### 3.4 –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ .env —Ñ–∞–π–ª–∞

```bash
nano .env
```

**–ó–∞–º–µ–Ω–∏—Ç–µ:**
- `–ó–ê–ú–ï–ù–ò–¢–ï_–ù–ê_–°–ï–ö–†–ï–¢–ù–´–ô_–ö–õ–Æ–ß` ‚Üí –Ω–∞ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π DJANGO_SECRET_KEY
- `–í–ê–®_IP_–ê–î–†–ï–°` ‚Üí –Ω–∞ IP –≤–∞—à–µ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞ (–º–æ–∂–Ω–æ —É–∑–Ω–∞—Ç—å –∫–æ–º–∞–Ω–¥–æ–π `hostname -I`)
- `–°–ò–õ–¨–ù–´–ô_–ü–ê–†–û–õ–¨_–ë–î_–ó–ê–ú–ï–ù–ò–¢–ï` ‚Üí –ø—Ä–∏–¥—É–º–∞–π—Ç–µ –ø–∞—Ä–æ–ª—å –¥–ª—è –ë–î (–º–∏–Ω–∏–º—É–º 16 —Å–∏–º–≤–æ–ª–æ–≤)
- `–°–ò–õ–¨–ù–´–ô_–ü–ê–†–û–õ–¨_MINIO_–ó–ê–ú–ï–ù–ò–¢–ï` ‚Üí –ø—Ä–∏–¥—É–º–∞–π—Ç–µ –ø–∞—Ä–æ–ª—å –¥–ª—è MinIO
- –ï—Å–ª–∏ –µ—Å—Ç—å –¥–æ–º–µ–Ω ‚Üí –¥–æ–±–∞–≤—å—Ç–µ –µ–≥–æ –≤ `ALLOWED_HOSTS` –∏ `CORS_ALLOWED_ORIGINS`

**–°–æ—Ö—Ä–∞–Ω–∏—Ç–µ:** `Ctrl + O`, `Enter`, `Ctrl + X`

---

## üìã –®–ê–ì 4: –ü–†–û–í–ï–†–ö–ê DOCKER-COMPOSE –§–ê–ô–õ–ê

```bash
cd ~/ringo-uchet/backend
ls -la docker-compose.prod.yml
```

**–ï—Å–ª–∏ —Ñ–∞–π–ª –µ—Å—Ç—å** ‚Üí –ø—Ä–æ–¥–æ–ª–∂–∞–µ–º. –ï—Å–ª–∏ –Ω–µ—Ç ‚Üí –Ω–∞–ø–∏—à–∏—Ç–µ –º–Ω–µ.

---

## ‚úÖ –ü–†–û–í–ï–†–ö–ê

```bash
cd ~/ringo-uchet/backend
cat .env | head -5
```

**–î–æ–ª–∂–µ–Ω –ø–æ–∫–∞–∑–∞—Ç—å –ø–µ—Ä–≤—ã–µ —Å—Ç—Ä–æ–∫–∏ –≤–∞—à–µ–≥–æ .env —Ñ–∞–π–ª–∞.**

---

## ‚è≠Ô∏è –°–õ–ï–î–£–Æ–©–ò–ô –®–ê–ì

**–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –Ω–∞–ø–∏—à–∏—Ç–µ:**
- ‚úÖ **"–ì–æ—Ç–æ–≤–æ, –ø—Ä–æ–µ–∫—Ç –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –∏ .env –Ω–∞—Å—Ç—Ä–æ–µ–Ω"** - –ø–µ—Ä–µ–π–¥–µ–º –∫ –∑–∞–ø—É—Å–∫—É Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤

---

**–°—Ç–∞—Ç—É—Å:** ‚è≥ –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ Backend

**–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:** 10-15 –º–∏–Ω—É—Ç

