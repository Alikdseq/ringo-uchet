## Требования к PDF (счёт / акт / чек)

### Общая информация
- Генерация на сервере (Celery task) с WeasyPrint или wkhtmltopdf.
- Верстка: HTML + CSS, поддержка brand guide, логотип (SVG/PNG), водяной знак (опционально).
- Страницы формата A4, портретная ориентация, отступы 15 мм.
- Шрифты: Inter/Arial (поддержка кириллицы).
- Локализация: RU (по умолчанию), EN — через шаблонные блоки.

### Структура счёта/акта
1. **Шапка**:
   - Логотип компании.
   - Реквизиты: название, адрес, ИНН/КПП, банк, БИК, расчётный счёт.
   - Контакты менеджера (ФИО, телефон, email).
   - QR-код (ссылка на заказ / оплату / проверку PDF).
2. **Информация о клиенте**:
   - Название / ФИО, адрес, телефон, email.
   - Номер договора/заказа, дата создания, статус.
3. **Детальная таблица**:
   - Столбцы: №, Наименование, Кол-во, Ед., Ставка, Сумма (автоматически).
   - Группировка: техника, услуги, материалы, доп. расходы.
   - Доп. строки для скидок/штрафов/налогов.
4. **Итоги**:
   - Подитог, скидки/надбавки, НДС (если применимо), итоговая сумма.
   - Предоплата, к оплате, валюта.
5. **Комментарии**:
   - Условия оплаты, SLA, примечания по работам/материалам.
6. **Подписи**:
   - Ответственный менеджер (цифровая подпись/ФИО).
   - Представитель клиента (пустое поле для печати).
   - Печати (опционально).

### Технические требования
- Все значения берутся из `Order.price_snapshot`, чтобы PDF соответствовал расчёту на момент генерации.
- Ссылки на изображения (фото техники, подписи) — через временные подписанные URL (S3 presigned).
- QR-код генерируется на сервере (например, `qrcode` Python) и встраивается Base64.
- Поддержка двух темплейтов: «Счёт» (Invoice), «Акт выполненных работ» (Act), «Чек» (опционально).
- Каждый шаблон версионируется: хранить ID версии, чтобы старые документы можно было воспроизвести.
- Логи генерации: `PdfGenerationLog (order, template, succeeded, error, duration, generated_by)`.

### Интеграции
- Отправка PDF клиенту: email + ссылка на скачивание + WhatsApp (через API клиента, если будет).
- Возможность повторной генерации с фиксацией причины (например, правка реквизитов).
- Архивирование в S3 с политикой хранения (минимум 3 года).

### UX-требования
- В мобильном/веб-интерфейсе: кнопка «Сгенерировать PDF» доступна после `COMPLETED`.
- Прогресс-бар генерации (job status), уведомление после готовности.
- Просмотр PDF внутри приложения (viewer) + опция «Поделиться».

