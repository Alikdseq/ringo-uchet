# üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–æ–∫ –≤–µ–±-–≤–µ—Ä—Å–∏–∏

## –ü—Ä–æ–±–ª–µ–º—ã, –∫–æ—Ç–æ—Ä—ã–µ –±—ã–ª–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã

### 1. ‚úÖ "Refused to set unsafe header 'Accept-Encoding'"

**–ü—Ä–æ–±–ª–µ–º–∞:** –ë—Ä–∞—É–∑–µ—Ä –Ω–µ –ø–æ–∑–≤–æ–ª—è–µ—Ç —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å –∑–∞–≥–æ–ª–æ–≤–æ–∫ `Accept-Encoding` –≤—Ä—É—á–Ω—É—é, —Ç–∞–∫ –∫–∞–∫ –æ–Ω —É–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –±—Ä–∞—É–∑–µ—Ä–æ–º –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.

**–†–µ—à–µ–Ω–∏–µ:** –£–±—Ä–∞–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–∫—É –∑–∞–≥–æ–ª–æ–≤–∫–∞ `Accept-Encoding` –¥–ª—è –≤–µ–±-–ø–ª–∞—Ç—Ñ–æ—Ä–º—ã –≤ `dio_client.dart`. –¢–µ–ø–µ—Ä—å –∑–∞–≥–æ–ª–æ–≤–æ–∫ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö –ø–ª–∞—Ç—Ñ–æ—Ä–º.

**–§–∞–π–ª:** `mobile/lib/core/network/dio_client.dart`

```dart
// –ë–∞–∑–æ–≤—ã–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏
final headers = <String, dynamic>{
  'Content-Type': 'application/json',
  'Accept': 'application/json',
};

// –ù–ï —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º Accept-Encoding –¥–ª—è –≤–µ–±-–ø–ª–∞—Ç—Ñ–æ—Ä–º—ã
// –ë—Ä–∞—É–∑–µ—Ä –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–ø—Ä–∞–≤–ª—è–µ—Ç —ç—Ç–∏–º –∑–∞–≥–æ–ª–æ–≤–∫–æ–º
if (!kIsWeb) {
  headers['Accept-Encoding'] = 'gzip, deflate';
}
```

---

### 2. ‚úÖ "Token refresh failed: Refresh token –Ω–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω"

**–ü—Ä–æ–±–ª–µ–º–∞:** –ü—Ä–∏ –Ω–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ–º refresh token –ø—Ä–æ–∏—Å—Ö–æ–¥–∏–ª–∏ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø–æ–ø—ã—Ç–∫–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ç–æ–∫–µ–Ω–∞, —á—Ç–æ –ø—Ä–∏–≤–æ–¥–∏–ª–æ –∫ –æ—à–∏–±–∫–∞–º –≤ –∫–æ–Ω—Å–æ–ª–∏.

**–†–µ—à–µ–Ω–∏–µ:** 
- –£–ª—É—á—à–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ refresh token –≤ `auth_interceptor.dart`
- –ü—Ä–∏ –Ω–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ–º refresh token —Ç–æ–∫–µ–Ω—ã –æ—á–∏—â–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- –£–ª—É—á—à–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≤ `auth_notifier.dart` - –ø—Ä–∏ `UnauthorizedException` —Ç–æ–∫–µ–Ω—ã –æ—á–∏—â–∞—é—Ç—Å—è, –Ω–æ –ø–∞—Ä–æ–ª—å –∏ —Ç–µ–ª–µ—Ñ–æ–Ω —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –≤—Ö–æ–¥–∞

**–§–∞–π–ª—ã:**
- `mobile/lib/core/network/interceptors/auth_interceptor.dart`
- `mobile/lib/features/auth/notifiers/auth_notifier.dart`

---

## –†–µ–∑—É–ª—å—Ç–∞—Ç

‚úÖ –£–±—Ä–∞–Ω—ã –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è "Refused to set unsafe header 'Accept-Encoding'"  
‚úÖ –£–ª—É—á—à–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö refresh token  
‚úÖ –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –≤–µ–±-–ø–ª–∞—Ç—Ñ–æ—Ä–º–µ  
‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—Ö–æ–¥ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –¥–∞–∂–µ –ø—Ä–∏ –∏—Å—Ç–µ–∫—à–∏—Ö —Ç–æ–∫–µ–Ω–∞—Ö  

---

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### Accept-Encoding –∑–∞–≥–æ–ª–æ–≤–æ–∫

–ë—Ä–∞—É–∑–µ—Ä—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è—é—Ç –∑–∞–≥–æ–ª–æ–≤–æ–∫ `Accept-Encoding` –∫ –∫–∞–∂–¥–æ–º—É HTTP-–∑–∞–ø—Ä–æ—Å—É. –ü–æ–ø—ã—Ç–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –µ–≥–æ –≤—Ä—É—á–Ω—É—é —á–µ—Ä–µ–∑ JavaScript/Dart –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—é –≤ –∫–æ–Ω—Å–æ–ª–∏, —Ç–∞–∫ –∫–∞–∫ —ç—Ç–æ —Å—á–∏—Ç–∞–µ—Ç—Å—è –Ω–µ–±–µ–∑–æ–ø–∞—Å–Ω—ã–º –¥–µ–π—Å—Ç–≤–∏–µ–º.

**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–ª–∞—Ç—Ñ–æ—Ä–º—É —á–µ—Ä–µ–∑ `kIsWeb` –∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ —Ç–æ–ª—å–∫–æ –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö –ø–ª–∞—Ç—Ñ–æ—Ä–º.

### Refresh Token –æ–±—Ä–∞–±–æ—Ç–∫–∞

–ü—Ä–∏ –Ω–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ–º refresh token:
1. –¢–æ–∫–µ–Ω—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—á–∏—â–∞—é—Ç—Å—è
2. –ü–∞—Ä–æ–ª—å –∏ —Ç–µ–ª–µ—Ñ–æ–Ω —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –≤—Ö–æ–¥–∞
3. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –ø—Ä–æ–¥–æ–ª–∂–∞—Ç—å —Ä–∞–±–æ—Ç–∞—Ç—å —Å –∫—ç—à–µ–º –¥–∞–Ω–Ω—ã—Ö
4. –ü—Ä–∏ —Å–ª–µ–¥—É—é—â–µ–º –∑–∞–ø—Ä–æ—Å–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—Ö–æ–¥ —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏

---

**–î–∞—Ç–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:** 2024

