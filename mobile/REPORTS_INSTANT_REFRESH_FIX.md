# ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º–æ–º–µ–Ω—Ç–∞–ª—å–Ω–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –æ—Ç—á–µ—Ç–æ–≤

## üîç –ü—Ä–æ–±–ª–µ–º–∞

1. **–ü—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω–æ–π –∑–∞—è–≤–∫–∏** - –æ—Ç—á–µ—Ç—ã –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è, –Ω–æ –Ω–µ —Å—Ä–∞–∑—É (–Ω—É–∂–Ω–æ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞—Ç—å —ç–∫—Ä–∞–Ω –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑)
2. **–ü—Ä–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ –∑–∞—è–≤–∫–∏** - –æ—Ç—á–µ—Ç—ã –Ω–µ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è —Å—Ä–∞–∑—É, –Ω—É–∂–Ω–æ –∂–¥–∞—Ç—å –∏–ª–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞—Ç—å

## üîß –ù–∞–π–¥–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

1. ‚úÖ –ü—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –∑–∞—è–≤–∫–∏ –µ—Å—Ç—å –≤—ã–∑–æ–≤ `reportsRefreshProvider.notifier.state++` 
2. ‚ùå –ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Å—Ç–∞—Ç—É—Å–∞ –∑–∞—è–≤–∫–∏ (–≤–∫–ª—é—á–∞—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ) –ù–ï –±—ã–ª–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –æ—Ç—á–µ—Ç–æ–≤
3. ‚ùå –ü—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –∑–∞—è–≤–∫–∏ (updateOrder) –Ω–µ –±—ã–ª–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –æ—Ç—á–µ—Ç–æ–≤, –µ—Å–ª–∏ –∑–∞—è–≤–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞

## ‚úÖ –†–µ—à–µ–Ω–∏–µ

### 1. –î–æ–±–∞–≤–ª–µ–Ω–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç—á–µ—Ç–æ–≤ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Å—Ç–∞—Ç—É—Å–∞ –∑–∞—è–≤–∫–∏

**–§–∞–π–ª:** `mobile/lib/features/orders/screens/order_detail_screen.dart`
**–ú–µ—Ç–æ–¥:** `_changeStatus` (—Å—Ç—Ä–æ–∫–∞ 133)

**–ò–∑–º–µ–Ω–µ–Ω–∏–µ:** –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞ –¥–æ–±–∞–≤–ª–µ–Ω –≤—ã–∑–æ–≤ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –æ—Ç—á–µ—Ç–æ–≤:
```dart
// –ö–†–ò–¢–ò–ß–ù–û: –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç—á–µ—Ç—ã –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Å—Ç–∞—Ç—É—Å–∞ (–æ—Å–æ–±–µ–Ω–Ω–æ –ø—Ä–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏)
ref.read(reportsRefreshProvider.notifier).state++;
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Å—Ç–∞—Ç—É—Å–∞ –∑–∞—è–≤–∫–∏ (–≤–∫–ª—é—á–∞—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ) –æ—Ç—á–µ—Ç—ã –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –º–æ–º–µ–Ω—Ç–∞–ª—å–Ω–æ.

### 2. –î–æ–±–∞–≤–ª–µ–Ω–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç—á–µ—Ç–æ–≤ –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω–æ–π –∑–∞—è–≤–∫–∏

**–§–∞–π–ª:** `mobile/lib/features/orders/screens/order_detail_screen.dart`
**–ú–µ—Ç–æ–¥—ã:** –ì–¥–µ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è `updateOrder` (—Å—Ç—Ä–æ–∫–∏ 922 –∏ 1024)

**–ò–∑–º–µ–Ω–µ–Ω–∏–µ:** –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∑–∞—è–≤–∫–∏, –µ—Å–ª–∏ –∑–∞—è–≤–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞, –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –æ—Ç—á–µ—Ç—ã:
```dart
// –ö–†–ò–¢–ò–ß–ù–û: –ï—Å–ª–∏ –∑–∞—è–≤–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞, –æ–±–Ω–æ–≤–ª—è–µ–º –æ—Ç—á–µ—Ç—ã –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ
if (updatedOrder.status == OrderStatus.completed) {
  ref.read(reportsRefreshProvider.notifier).state++;
}
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ü—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω–æ–π –∑–∞—è–≤–∫–∏ –æ—Ç—á–µ—Ç—ã –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –º–æ–º–µ–Ω—Ç–∞–ª—å–Ω–æ.

---

## üìù –î–µ—Ç–∞–ª–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–π

### –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –∑–∞—è–≤–∫–∏

**–î–æ:**
```dart
await orderService.changeOrderStatus(widget.orderId, result);
await _loadOrder();
// ‚ùå –ù–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –æ—Ç—á–µ—Ç–æ–≤
```

**–ü–æ—Å–ª–µ:**
```dart
await orderService.changeOrderStatus(widget.orderId, result);
await _loadOrder();
// ‚úÖ –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç—á–µ—Ç—ã –º–æ–º–µ–Ω—Ç–∞–ª—å–Ω–æ
ref.read(reportsRefreshProvider.notifier).state++;
```

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞—è–≤–∫–∏

**–î–æ:**
```dart
final updatedOrder = await orderService.updateOrder(widget.orderId, request);
await _loadOrder();
// ‚ùå –ù–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –æ—Ç—á–µ—Ç–æ–≤
```

**–ü–æ—Å–ª–µ:**
```dart
final updatedOrder = await orderService.updateOrder(widget.orderId, request);
await _loadOrder();
// ‚úÖ –ï—Å–ª–∏ –∑–∞—è–≤–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞, –æ–±–Ω–æ–≤–ª—è–µ–º –æ—Ç—á–µ—Ç—ã
if (updatedOrder.status == OrderStatus.completed) {
  ref.read(reportsRefreshProvider.notifier).state++;
}
```

---

## üîÑ –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

### –ú–µ—Ö–∞–Ω–∏–∑–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –æ—Ç—á–µ—Ç–æ–≤:

1. **–¢—Ä–∏–≥–≥–µ—Ä:** –ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Å—Ç–∞—Ç—É—Å–∞/—É–¥–∞–ª–µ–Ω–∏–∏ –∑–∞—è–≤–∫–∏ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è `reportsRefreshProvider.notifier.state++`
2. **–†–µ–∞–∫—Ü–∏—è:** `reportsRefreshProvider` –∏–∑–º–µ–Ω—è–µ—Ç —Å–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
3. **–°–ª—É—à–∞—Ç–µ–ª—å:** `ReportsScreen` —Å–ª—É—à–∞–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è —á–µ—Ä–µ–∑ `ref.watch(reportsRefreshProvider)`
4. **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** –ò–∑–º–µ–Ω–µ–Ω–∏–µ `refreshKey` –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –∏–∑–º–µ–Ω–µ–Ω–∏—é `ValueKey` —Ç–∞–±–æ–≤ –æ—Ç—á–µ—Ç–æ–≤
5. **–ü–µ—Ä–µ—Å–æ–∑–¥–∞–Ω–∏–µ:** Flutter –ø–µ—Ä–µ—Å–æ–∑–¥–∞–µ—Ç —Ç–∞–±—ã —Å –Ω–æ–≤—ã–º `ValueKey`, –≤—ã–∑—ã–≤–∞—è `initState()`
6. **–ó–∞–≥—Ä—É–∑–∫–∞:** –í `initState()` –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è `_loadReport()`, –∫–æ—Ç–æ—Ä—ã–π –∑–∞–≥—Ä—É–∂–∞–µ—Ç –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

---

## üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç

–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:

‚úÖ **–ü—Ä–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ –∑–∞—è–≤–∫–∏** - –æ—Ç—á–µ—Ç—ã –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –º–æ–º–µ–Ω—Ç–∞–ª—å–Ω–æ  
‚úÖ **–ü—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω–æ–π –∑–∞—è–≤–∫–∏** - –æ—Ç—á–µ—Ç—ã –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –º–æ–º–µ–Ω—Ç–∞–ª—å–Ω–æ  
‚úÖ **–ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Å—Ç–∞—Ç—É—Å–∞ –∑–∞—è–≤–∫–∏** - –æ—Ç—á–µ—Ç—ã –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –º–æ–º–µ–Ω—Ç–∞–ª—å–Ω–æ  
‚úÖ **–ü—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω–æ–π –∑–∞—è–≤–∫–∏** - –æ—Ç—á–µ—Ç—ã –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –º–æ–º–µ–Ω—Ç–∞–ª—å–Ω–æ  
‚úÖ **–ù–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —ç–∫—Ä–∞–Ω–∞** - –≤—Å–µ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

---

## üìä –ò–∑–º–µ–Ω–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

1. **`mobile/lib/features/orders/screens/order_detail_screen.dart`**
   - –ú–µ—Ç–æ–¥ `_changeStatus` - –¥–æ–±–∞–≤–ª–µ–Ω–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç—á–µ—Ç–æ–≤
   - –ú–µ—Ç–æ–¥—ã —Å `updateOrder` - –¥–æ–±–∞–≤–ª–µ–Ω–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç—á–µ—Ç–æ–≤ –¥–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ã—Ö –∑–∞—è–≤–æ–∫

---

## ‚ö†Ô∏è –í–∞–∂–Ω–æ

- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç—á–µ—Ç–æ–≤ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —á–µ—Ä–µ–∑ `reportsRefreshProvider`, –∫–æ—Ç–æ—Ä—ã–π —Ç—Ä–∏–≥–≥–µ—Ä–∏—Ç –ø–µ—Ä–µ—Å–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–æ–≤ –æ—Ç—á–µ—Ç–æ–≤
- `ValueKey` —Å `refreshKey` –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –ø–µ—Ä–µ—Å–æ–∑–¥–∞–Ω–∏–µ –≤–∏–¥–∂–µ—Ç–æ–≤
- –û—Ç—á–µ—Ç—ã –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è —Å —Å–µ—Ä–≤–µ—Ä–∞ –ø—Ä–∏ –∫–∞–∂–¥–æ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∞–∫—Ç—É–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- –ù–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è UI - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ –≤ —Ñ–æ–Ω–µ

---

## ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –∏ –≥–æ—Ç–æ–≤–æ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é

–í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø—Ä–∏–º–µ–Ω–µ–Ω—ã. –û—Ç—á–µ—Ç—ã —Ç–µ–ø–µ—Ä—å –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –º–æ–º–µ–Ω—Ç–∞–ª—å–Ω–æ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –∑–∞—è–≤–æ–∫.

