# ‚ö° –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –º–≥–Ω–æ–≤–µ–Ω–Ω—ã—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π

## ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏

### 1. –ú–≥–Ω–æ–≤–µ–Ω–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç—á–µ—Ç–æ–≤ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –∑–∞—è–≤–∫–∏

**–ü—Ä–æ–±–ª–µ–º–∞:** –ü—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –∑–∞—è–≤–∫–∏ –æ—Ç—á–µ—Ç—ã –æ–±–Ω–æ–≤–ª—è–ª–∏—Å—å —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ —Ä—É—á–Ω–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∏–ª–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏.

**–†–µ—à–µ–Ω–∏–µ:**
- –°–æ–∑–¥–∞–Ω –ø—Ä–æ–≤–∞–π–¥–µ—Ä `reportsRefreshProvider` –¥–ª—è —Ç—Ä–∏–≥–≥–µ—Ä–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –æ—Ç—á–µ—Ç–æ–≤
- –ü—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –∑–∞—è–≤–∫–∏ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è `triggerReportsRefresh(ref)`
- –í—Å–µ –≤–∫–ª–∞–¥–∫–∏ –æ—Ç—á–µ—Ç–æ–≤ —Å–ª—É—à–∞—é—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è —ç—Ç–æ–≥–æ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞ —á–µ—Ä–µ–∑ `ValueKey`
- –ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞ –≤–∏–¥–∂–µ—Ç—ã –æ—Ç—á–µ—Ç–æ–≤ –ø–µ—Ä–µ—Å–æ–∑–¥–∞—é—Ç—Å—è –∏ –∑–∞–≥—Ä—É–∂–∞—é—Ç —Å–≤–µ–∂–∏–µ –¥–∞–Ω–Ω—ã–µ

**–§–∞–π–ª—ã:**
- `mobile/lib/core/providers/reports_refresh_provider.dart` - –Ω–æ–≤—ã–π –ø—Ä–æ–≤–∞–π–¥–µ—Ä
- `mobile/lib/features/finance/screens/reports_screen.dart` - –æ–±–Ω–æ–≤–ª–µ–Ω –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞
- `mobile/lib/features/orders/screens/order_detail_screen.dart` - –¥–æ–±–∞–≤–ª–µ–Ω –≤—ã–∑–æ–≤ —Ç—Ä–∏–≥–≥–µ—Ä–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ –û—Ç—á–µ—Ç—ã –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è **–º–≥–Ω–æ–≤–µ–Ω–Ω–æ** –ø–æ—Å–ª–µ —É–¥–∞–ª–µ–Ω–∏—è –∑–∞—è–≤–∫–∏
- ‚úÖ –û–±–Ω–æ–≤–ª—è—é—Ç—Å—è –≤—Å–µ —Ç—Ä–∏ –≤–∫–ª–∞–¥–∫–∏: –û–±—â–∏–µ, –ü–æ —Ç–µ—Ö–Ω–∏–∫–µ, –ü–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞–º

---

### 2. –ú–≥–Ω–æ–≤–µ–Ω–Ω–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–æ–≤–æ–π –Ω–æ–º–µ–Ω–∫–ª–∞—Ç—É—Ä—ã –≤ —Å–ø–∏—Å–∫–µ

**–ü—Ä–æ–±–ª–µ–º–∞:** –ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–º–µ–Ω–∫–ª–∞—Ç—É—Ä—ã (—Ç–µ—Ö–Ω–∏–∫–∞, —É—Å–ª—É–≥–∏, –≥—Ä—É–Ω—Ç, –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç, –Ω–∞–≤–µ—Å–∫–∞) –æ–Ω–∞ –Ω–µ –ø–æ—è–≤–ª—è–ª–∞—Å—å —Å—Ä–∞–∑—É –≤ —Å–ø–∏—Å–∫–µ.

**–†–µ—à–µ–Ω–∏–µ:**
- –ö—ç—à —É–∂–µ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –≤ —Å–µ—Ä–≤–∏—Å–∞—Ö (`catalog_service.dart`)
- –î–æ–±–∞–≤–ª–µ–Ω –º–µ—Ö–∞–Ω–∏–∑–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è UI —á–µ—Ä–µ–∑ `refreshKey`
- –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏/–æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –Ω–æ–º–µ–Ω–∫–ª–∞—Ç—É—Ä—ã `refreshKey` –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∏—Ä—É–µ—Ç—Å—è
- –í—Å–µ –≤–∏–¥–∂–µ—Ç—ã —Ç–∞–±–æ–≤ –∏—Å–ø–æ–ª—å–∑—É—é—Ç `ValueKey` —Å `refreshKey` –¥–ª—è –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–≥–æ –ø–µ—Ä–µ—Å–æ–∑–¥–∞–Ω–∏—è
- –ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è `true` –∏–∑ `_NomenclatureEditScreen`, —á—Ç–æ —Ç—Ä–∏–≥–≥–µ—Ä–∏—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ

**–§–∞–π–ª—ã:**
- `mobile/lib/features/catalog/screens/catalog_screen.dart` - –¥–æ–±–∞–≤–ª–µ–Ω `refreshKey` –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ UI
- `mobile/lib/features/catalog/screens/nomenclature_management_screen.dart` - —É–∂–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `true`

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ –ù–æ–≤–∞—è –Ω–æ–º–µ–Ω–∫–ª–∞—Ç—É—Ä–∞ –ø–æ—è–≤–ª—è–µ—Ç—Å—è **–º–≥–Ω–æ–≤–µ–Ω–Ω–æ** –≤ —Å–ø–∏—Å–∫–µ –ø–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è
- ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è –≤—Å–µ—Ö —Ç–∏–ø–æ–≤: —Ç–µ—Ö–Ω–∏–∫–∞, —É—Å–ª—É–≥–∏, –≥—Ä—É–Ω—Ç, –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç, –Ω–∞–≤–µ—Å–∫–∞
- ‚úÖ –ù–æ–º–µ–Ω–∫–ª–∞—Ç—É—Ä–∞ —Å—Ä–∞–∑—É –∞–∫—Ç–∏–≤–Ω–∞ –∏ –¥–æ—Å—Ç—É–ø–Ω–∞ –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

---

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç—á–µ—Ç–æ–≤

```dart
// –ü—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –∑–∞—è–≤–∫–∏
triggerReportsRefresh(ref);

// –í –æ—Ç—á–µ—Ç–∞—Ö –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è ValueKey —Å refreshKey
_SummaryReportTab(
  key: ValueKey('summary_${_selectedPeriod?.toString()}_$refreshKey'),
  ...
)
```

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–æ–º–µ–Ω–∫–ª–∞—Ç—É—Ä—ã

```dart
// –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏/–æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –Ω–æ–º–µ–Ω–∫–ª–∞—Ç—É—Ä—ã
Navigator.pop(context, true); // –í–æ–∑–≤—Ä–∞—â–∞–µ–º true

// –í —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–º –≤–∏–¥–∂–µ—Ç–µ
.then((result) {
  if (result == true) {
    setState(() {
      _refreshKey++; // –ò–Ω–∫—Ä–µ–º–µ–Ω—Ç–∏—Ä—É–µ–º –∫–ª—é—á
    });
  }
});

// –í–∏–¥–∂–µ—Ç—ã —Ç–∞–±–æ–≤ –ø–µ—Ä–µ—Å–æ–∑–¥–∞—é—Ç—Å—è —Å –Ω–æ–≤—ã–º –∫–ª—é—á–æ–º
_EquipmentTab(
  key: ValueKey('equipment_$_refreshKey'),
  ...
)
```

---

## üìä –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

1. **–ú–≥–Ω–æ–≤–µ–Ω–Ω–∞—è –æ–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å** - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å—Ä–∞–∑—É –≤–∏–¥–∏—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Å–≤–æ–∏—Ö –¥–µ–π—Å—Ç–≤–∏–π
2. **–ù–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –≤ —Ä—É—á–Ω–æ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏** - –≤—Å–µ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
3. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫—ç—à–∞** - –¥–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –∏–∑ –∫—ç—à–∞ –º–≥–Ω–æ–≤–µ–Ω–Ω–æ
4. **–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞** - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è Riverpod –¥–ª—è —Ä–µ–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏

---

## ‚úÖ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–î–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–±–æ—Ç—ã:

1. **–£–¥–∞–ª–µ–Ω–∏–µ –∑–∞—è–≤–∫–∏:**
   - –û—Ç–∫—Ä–æ–π—Ç–µ –∑–∞—è–≤–∫—É ‚Üí —É–¥–∞–ª–∏—Ç–µ –µ—ë
   - –û—Ç–∫—Ä–æ–π—Ç–µ –æ—Ç—á–µ—Ç—ã ‚Üí –æ–Ω–∏ –¥–æ–ª–∂–Ω—ã –æ–±–Ω–æ–≤–∏—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

2. **–°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–º–µ–Ω–∫–ª–∞—Ç—É—Ä—ã:**
   - –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π —ç–ª–µ–º–µ–Ω—Ç (—Ç–µ—Ö–Ω–∏–∫—É/—É—Å–ª—É–≥—É/–º–∞—Ç–µ—Ä–∏–∞–ª)
   - –í–µ—Ä–Ω–∏—Ç–µ—Å—å –∫ —Å–ø–∏—Å–∫—É ‚Üí —ç–ª–µ–º–µ–Ω—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Å—Ä–∞–∑—É –≤–∏–¥–µ–Ω

---

## üéØ –ò—Ç–æ–≥

- ‚úÖ –û—Ç—á–µ—Ç—ã –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –º–≥–Ω–æ–≤–µ–Ω–Ω–æ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –∑–∞—è–≤–æ–∫
- ‚úÖ –ù–æ–º–µ–Ω–∫–ª–∞—Ç—É—Ä–∞ –ø–æ—è–≤–ª—è–µ—Ç—Å—è –º–≥–Ω–æ–≤–µ–Ω–Ω–æ –ø–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è
- ‚úÖ –í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –±–µ–∑ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ–¥—Ö–æ–¥ —á–µ—Ä–µ–∑ –∫—ç—à –∏ —Ä–µ–∞–∫—Ç–∏–≤–Ω—ã–µ –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã

